<div class="v-collapse" id="widget-{{ id }}-tab-pane" data-flag="v-collapse" data-group="tab-widget-quantum" {% if forms.active is defined and forms.active == true %}data-state="visible"{% endif %}>
    {% if widget.id and widget.widgetMap.view != view %}
        <div class="vic-alert vic-alert-warning vic-alert-dismissible">
            {{ 'victoire.widget.inherited.notice'|trans({'%templateName%': widget.widgetMap.view.name, '%templateEditLink%': path('victoire_core_widget_edit', {'id': widget.id, 'viewReference': widget.widgetMap.view.reference.id })}, 'victoire')|raw }}
        </div>
    {% endif %}

    {% if classes|length %}
        <div class="v-tabs-nav v-tabs-nav--widget-modal">
            <div class="v-tabs-nav__item">
                <a class="v-tabs-nav__anchor {% if constant('MODE_STATIC', widget) == widget.mode %}v-tabs-nav__anchor--active{% endif %}" data-collapse="show" data-href="#picker-static-{{ quantum }}" data-activeclass="v-tabs-nav__anchor--active">
                    {{ ('form.widget.tab.manual.label')|trans({}, 'victoire') }}
                </a>
            </div>

            <div class="v-tabs-nav__item">
                <a class="v-tabs-nav__anchor" data-flag="v-drop" data-position="bottomout center" data-href="#picker-entities-{{ quantum }}">
                    entit√©s

                    <svg style="margin-left: 0.4em;" xmlns="http://www.w3.org/2000/svg" width="8" height="6" viewBox="65 6 8 6">
                        <path fill="currentColor" fill-rule="evenodd" d="M65.94 7L69 10.0904 72.06 7l.94.9514L69 12l-4-4.0486"/>
                    </svg>
                </a>

                {% if classes|length %}
                    <div class="v-drop" id="picker-entities-{{ quantum }}">
                        <nav class="v-drop__menu">
                            {% for class, namespace in classes %}
                                {% if namespace.disable %}
                                    <span class="v-drop__anchor v-drop__anchor--disabled" title="{{ ('form.widget.tab.entity.disable.label')|trans({}, 'victoire') }}">
                                        {{ ('form.widget.tab.' ~ class|lower ~ '.label')|trans({}, 'victoire') }}
                                    </span>
                                {% else %}
                                    <a class="v-drop__anchor {% if widget.businessEntityId == class|lower %} v-drop__anchor--active{% endif %}" data-href="#picker-{{ class|lower }}-{{ quantum }}" data-collapse="show">
                                        {{ ('form.widget.tab.' ~ class|lower ~ '.label')|trans({}, 'victoire') }}
                                    </a>
                                {% endif %}
                            {% endfor %}
                        </nav>
                    </div>
                {% endif %}
            </div>
        </div>
    {% endif %}

    {% for class, form in forms %}
        {% set isActive = class == widget.mode or widget.businessEntityId == class|lower and widget.mode == constant('MODE_BUSINESS_ENTITY', widget) %}

        <div class="v-collapse" id="picker-{{ class|lower }}-{{ quantum }}" data-group="picker-{{ quantum }}" data-flag="v-collapse"{% if isActive %} data-state="visible"{% endif %}>
            {% if class != constant('MODE_STATIC', widget) and is_granted('ROLE_VICTOIRE_DEVELOPER') %}
                <button class="v-btn v-btn--info" data-flag="v-drop" data-href="#picker-modes-{{ class|lower }}-{{ quantum }}">Mode</button>

                <div class="v-drop" id="picker-modes-{{ class|lower }}-{{ quantum }}">
                    <nav class="v-drop__menu">
                        <a class="v-drop__anchor" data-href="#picker-{{ class|lower }}-{{ quantum }}-entity">
                            {{ ('form.widget.tab.picker.label')|trans({}, 'victoire') }}
                        </a>

                        <a class="v-drop__anchor" data-href="#picker-{{ class|lower }}-{{ quantum }}-query">
                            {{ ('form.widget.tab.query.label')|trans({}, 'victoire') }}
                        </a>

                        {% if is_business_entity_allowed(class|lower, view) %}
                            <a class="v-drop__anchor" data-href="#picker-{{ class|lower }}-{{ quantum }}-businessEntity">
                                {{ ('form.widget.tab.entity_instance.label')|trans({}, 'victoire') }}
                            </a>
                        {% endif %}
                    </nav>
                </div>


                <ul class="vic-nav vic-nav-tabs vic-modal-nav-tabs">
                    <li class="{% if widget.mode == constant('MODE_ENTITY', widget) %}vic-active {% endif %}vic-seperate">
                        <a href="#picker-{{ class|lower }}-{{ quantum }}-entity" data-toggle="vic-tab">
                            {{ ('form.widget.tab.picker.label')|trans({}, 'victoire') }}
                        </a>
                    </li>

                    <li{% if widget.mode == constant('MODE_QUERY', widget) %} class="vic-active"{% endif %}>
                        <a href="#picker-{{ class|lower }}-{{ quantum }}-query" data-toggle="vic-tab">
                            {{ ('form.widget.tab.query.label')|trans({}, 'victoire') }}
                        </a>
                    </li>

                    {% if is_business_entity_allowed(class|lower, view) %}
                        <li{% if widget.mode == constant('MODE_BUSINESS_ENTITY', widget) %} class="vic-active"{% endif %}>
                            <a href="#picker-{{ class|lower }}-{{ quantum }}-businessEntity" data-toggle="vic-tab">
                                {{ ('form.widget.tab.entity_instance.label')|trans({}, 'victoire') }}
                            </a>
                        </li>
                    {% endif %}
                </ul>

                <div class="vic-tab-content vic-modal-tab-content">
                    {% for subForm in form %}
                        {{ subForm|raw }}
                    {% endfor %}
                </div>
            {% else %}
                {% for el, subForm in form %}
                    {{ subForm|raw }}
                {% endfor %}
            {% endif %}
        </div>
    {% endfor %}
</div>
